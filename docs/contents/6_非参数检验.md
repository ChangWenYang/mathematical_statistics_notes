# 非参数检验





## 参数检验与非参数检验的区别

### 参数检验的特点

+ 假定随机样本来自可用有限个参数$(\mu,\sigma^2,p)$等进行描述的总体
+ 总体分布类型已知
+ 数据符合参数检验的应用条件
+ 可用$Z$检验，$T$检验，$\chi^2$检验和方差分析等方法对总体参数进行检验

### 问题引入

+ 一类数据的特点：
  + 资料总体分布类型未知
  + 资料分布类型已知，但不符合正态分布；
  + 某些变量可能无法精确测量
  + 例子：比较患者和正常人的血铅值，两种理财产品的风险评分等
+ 对于此类数据，除了进行变量变化或参数检验外，还可以采用非参数检验的方法进行假设检验



## 非参数检验概述

### 非参数检验（nonparametric statistics）

#### 目标

+ 检验单样本所代表的总体分布是否是指定的分布
+ 检验多样本所代表的总体分布形式是否一致

#### 特点

+ 不考虑研究对象总体分布具体形式
+ 不对总体参数进行统计推断

#### 应用

+ 总体分布不易确定
+ 数据为非正态分布且无合适的数据转换方法
+ 难以精确测量的资料，如等级资料

### 非参数分析方法的优缺点

#### 优点

+ 不受总体分布条件的限制，适用范围广，某些不便准去测定，只能以严重程度，好坏优劣，次第先后等作记录的资料也可应用

#### 缺点

+ 适用于参数检验的资料，如用非参数检验会造成信息的丢失，导致检验功效的下降
  + 即当原假设不真时，非参数检验将不如参数检验能较灵敏地拒绝原假设，犯第二类错误的概率要比参数检验大。



## 单样本的非参数检验

### 目标

+ 判断样本来自总体的分布是否于某个已知的分布相吻合
  + 判断方法：直方图，$P-P$图，$Q-Q$图，非参数检验
+ 单样本非参数检验可以对单个总体的分布形态进行推断
  + 方法：卡方检验，K-S检验

### 总体分布的卡方检验

#### 原假设

$H_0:$ 样本来自的总体分布与期望分布无显著差异
$$
\chi^2=\sum_{i=1}^k\frac{(f_i^o-f_i^e)^2}{f_i^e}\sim \chi^2(k-1)
$$


### 单样本的K-S检验

#### 原假设

$H_0:$ 总体服从某一理论分布（适用于正态分布，指数分布，均匀分布及泊松分布）

#### 步骤

1. 计算各样本观测值在理论分布中出现的理论累计概率值$F(x)$
2. 计算各样本观测值的实际累计概率值$S(x)$
3. 计算理论累计概率值与实际累计概率值的差$D(x)$
4. 计算差值序列中最大绝对差值$D$,作为统计量

$$
D=max(|S(x_i)-F(x_i)|)
$$

由于实际累计概率为离散值，可对$D$修正为:
$$
D=max(max(|S(x_i)-F(x_i)|),max(|S(x_{i-1})-F(x_i)|))
$$

5. $H_0$成立时：
   + 小样本下：$D\sim Kolmogorov$分布
   + 大样本下：$\sqrt{n} D$近似服从$K(x)$分布

$$
K(x)=\sum_{j=-\infty}^{+\infty}(-1)e^{-2j^2x^2}
$$

6. 决策
   + D统计量的$p$值$<$显著性水平，拒绝原假设，样本来自的总体与指定分布有显著差异
   + D统计量的$p$值$>$显著性水平，不拒绝原假设，样本来自的总体与指定分布无显著差异



## 两个独立样本的非参数检验

### 基本思想

1. 独立样本
2. 推断样本来自的两个总体的**分布**是否存在**显著差异**

### 方法

+ $K-S$检验
+ $Mann-Whitney\ U$检验
+ $W-W$游程检验
+ 极端反应检验



### 两独立样本的$K-S$检验

#### 原假设

$H_0:$两组独立样本来自同一总体

#### 与单样本检验的差异

以变量值的秩为分析对象，而非变量值本身

#### 步骤

1. 将两组样本混合并按升序排列
2. 分别计算两组样本秩的累计频数和累计频率
3. 计算两组累计频率的差，得秩的差值序列及$D$统计量及$\sqrt n D(n=\frac{n_1n_2}{n_1+n_2})$
4. p值决策

